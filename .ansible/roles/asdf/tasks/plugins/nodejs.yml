---
# asdf nodejs tasks
- name: Copy npm defaults template
  template:
    src: .default-npm-packages.j2
    dest: "{{ asdf_home }}/.default-npm-packages"
    mode: 0644
  when: asdf_npm_packages is defined

- name: Check if node.js keyring exists
  stat:
    path: "{{ asdf_nodejs_keyring }}"
  register: keyring

- name: Create keyring for Node.js keys
  file:
    path: "{{ asdf_nodejs_keyring }}"
    state: directory
    mode: 0700

- name: Import Node.js keys to keyring
  command:
    bash -lc '{{ asdf_dir }}/plugins/nodejs/bin/import-release-team-keyring'
  args:
    creates: "{{ asdf_nodejs_keyring }}/pubring.gpg"
  environment:
    GNUPGHOME: "{{ asdf_nodejs_keyring }}"
  changed_when: false

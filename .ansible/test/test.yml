---
- name: Test tasks
  hosts: jupiter
  tasks:
    - name: Print facts
      debug:
        var: ansible_facts
        verbosity: 2

    - name: Print arch
      debug:
        msg: |-
          System: {{ ansible_facts.system }}
          Arch:   {{ ansible_facts.architecture }}

    - name: Check for line in .tool-versions
      command: grep -i 'python 3' {{ ansible_facts.user_dir }}/.tool-versions
      register: asdf_python_version
      changed_when: false

    # - name: Get python version

    - name: Set python dir
      set_fact:
        asdf_python_bin_dir: "{{ asdf_dir }}/installs/python/{{ asdf_python_version.stdout|replace('python ', '') }}/bin"
      when: asdf_python_version.stdout is defined

    - name: Set python paths
      set_fact:
        pipx_pip3_path: "{{ asdf_python_bin_dir }}/pip3"
        pipx_path: "{{ asdf_python_bin_dir }}/pipx"
      when: asdf_python_bin_dir is defined

    - name: Debug paths
      debug:
        msg: |
          asdf python bin dir: {{ asdf_python_bin_dir|default('') }}
          pipx pip3 path:      {{ pipx_pip3_path }}
          pipx path:           {{ pipx_path }}


# vim:ft=yaml.ansible:
